(self.webpackChunkconteggio_ore=self.webpackChunkconteggio_ore||[]).push([[753],{328:(e,o,t)=>{"use strict";t.r(o),t.d(o,{exportHoursAsExcel:()=>a});var n=t(295),s=t(866),l=t(40);function a(){try{fetch(s).then((e=>{if(!e.ok)throw new Error(`HTTP ${e.status} - ${e.statusText}`);return e.arrayBuffer()})).then((async e=>{const o=new n.Workbook;await o.xlsx.load(e),o.created=new Date,o.modified=new Date,console.log("Loaded excel file"),console.log(o);const t=o.worksheets[0];console.log(t),t.getCell("B1").value=(0,l.Bv)().month(document.getElementById("month_selector").value-1).format("MMMM").capitalize(),t.getCell("C1").value=parseInt(document.getElementById("year_selector").value),t.getCell("C36").value=parseFloat(document.getElementById("total_hours").innerText);const s=(0,l.R1)();let a=[],c=[],r=[],u=[];s.days.forEach((e=>{a.push(e.day_name),c.push(parseInt(e.day_number)),r.push(parseFloat(e.hours)),u.push(e.notes)})),console.log(a);{t.getColumn(1).values=[,,,,].concat(a),t.getColumn(2).values=[,,,,].concat(c),t.getColumn(3).values=[,,,,].concat(r),t.getColumn(4).values=[,,,,].concat(u);let e=31,o=(0,l.Bv)().month(s.month-1).daysInMonth();for(;e!==o;)t.spliceRows(e+3,1),e--}const h=await o.xlsx.writeBuffer(),m=new Uint8Array(h);(0,l.LR)(m,"xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")})).catch((e=>{console.error(e)}))}catch(e){console.error(e)}}console.log(l.Bv)},866:(e,o,t)=>{"use strict";e.exports=t.p+"ef1607d270cbe903c22f.xlsx"}}]);